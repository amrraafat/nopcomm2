@model TopMenuModel
@using Nop.Core.Domain.Catalog
@using Nop.Core.Domain.Topics

<div class="rd-navbar-wrap rd-navbar-corporate">
    <nav class="rd-navbar" data-layout="rd-navbar-fixed" data-sm-layout="rd-navbar-fixed" data-md-layout="rd-navbar-fixed" data-md-device-layout="rd-navbar-fixed" data-lg-layout="rd-navbar-fullwidth" data-xl-layout="rd-navbar-static" data-lg-device-layout="rd-navbar-fixed" data-xl-device-layout="rd-navbar-static" data-md-stick-up-offset="130px" data-lg-stick-up-offset="100px" data-stick-up="true" data-sm-stick-up="true" data-md-stick-up="true" data-lg-stick-up="true" data-xl-stick-up="true">
        <div class="rd-navbar-collapse-toggle" data-rd-navbar-toggle=".rd-navbar-collapse"><span></span></div>
        <div class="rd-navbar-top-panel rd-navbar-collapse novi-background">
            <div class="rd-navbar-top-panel-inner">
                <nav class="top-menu">
                    <div class="headerlinks">
                        @await Component.InvokeAsync(typeof(WidgetViewComponent), new { widgetZone = PublicWidgetZones.HeaderBefore })
                        @await Component.InvokeAsync(typeof(HeaderLinksViewComponent))
                    </div>
                </nav>
                <div class="search-box store-search-box pull-right">
                    @await Component.InvokeAsync(typeof(SearchBoxViewComponent))
                </div>
            </div>
            <div class="rd-navbar-top-panel-inner"><a class="button button-sm button-secondary button-nina" href="https://www.templatemonster.com/website-templates/62466.html" target="_blank">buy template now</a></div>
        </div>
        <div class="rd-navbar-inner">
            <div class="rd-navbar-panel">
                <button class="rd-navbar-toggle" data-rd-navbar-toggle=".rd-navbar-nav-wrap"><span></span></button>
                                @await Component.InvokeAsync(typeof(LogoViewComponent))
            </div>
            <div class="rd-navbar-aside-center">
                <div class="rd-navbar-nav-wrap">
                    <ul class="rd-navbar-nav">
                        @await Component.InvokeAsync(typeof(WidgetViewComponent), new { widgetZone = PublicWidgetZones.HeaderMenuBefore, additionalData = Model })
                        @if (Model.DisplayHomepageMenuItem)
                        {
                            <li><a href="@Url.RouteUrl("Homepage")"><i class="fa fa-home fa-fw"></i></a></li>
                        }
                        @if (!Model.UseAjaxMenu)
                        {
                            var rootCategories = Model.Categories.Where(x => x.IncludeInTopMenu).ToList();
                            @foreach (var category in rootCategories)
                            {
                                var categoryLineModel = new TopMenuModel.CategoryLineModel
                    {
                        Category = category
                    };
                                @await Html.PartialAsync("_CategoryLine.TopMenu", categoryLineModel)
                            }
                        }
                        @foreach (var topic in Model.Topics)
                        {
                            <li><a href="@(Url.RouteUrl<Topic>(new { SeName = topic.SeName }))">@topic.Name</a></li>
                        }
                        @if (Model.NewProductsEnabled && Model.DisplayNewProductsMenuItem)
                        {
                            <li><a href="@Url.RouteUrl("NewProducts")">@T("Products.NewProducts")</a></li>
                        }
                        @if (Model.DisplayProductSearchMenuItem)
                        {
                            <li><a href="@Url.RouteUrl("ProductSearch")">@T("Search")</a></li>
                        }
                        @if (Model.DisplayCustomerInfoMenuItem)
                        {
                            <li><a href="@Url.RouteUrl("CustomerInfo")">@T("Account.MyAccount")</a></li>
                        }
                        @if (Model.BlogEnabled && Model.DisplayBlogMenuItem)
                        {
                            <li><a href="@Url.RouteUrl("Blog")">@T("Blog")</a></li>
                        }
                        @if (Model.ForumEnabled && Model.DisplayForumsMenuItem)
                        {
                            <li><a href="@Url.RouteUrl("Boards")">@T("Forum.Forums")</a></li>
                        }
                        @if (Model.DisplayContactUsMenuItem)
                        {
                            <li><a href="@Url.RouteUrl("ContactUs")">@T("ContactUs")</a></li>
                        }
                        @await Component.InvokeAsync(typeof(WidgetViewComponent), new { widgetZone = PublicWidgetZones.HeaderMenuAfter, additionalData = Model })
                    </ul>
                </div>
            </div>
            <div class="rd-navbar-aside-right"><a class="button button-sm button-secondary button-nina" href="#">Book a tour now</a></div>
        </div>
    </nav>
</div>

@if (Model.UseAjaxMenu)
{
    <script asp-location="Footer">
            $(document).ready(function () {
                $('#mobile-menu .dropdown .fa-angle-down').on('click', function () {
                    var $this = $(this);
                    $this.siblings("ul.dropdown-menu").slideToggle("slow");
                });
                var localized_data = {
                    AjaxFailure: "@T("MainMenu.AjaxFailure")"
                };
                mainMenu.init('@Url.RouteUrl("GetCatalogRoot")', '@Url.RouteUrl("GetCatalogSubCategories")', 'ul.top-menu.notmobile', 'ul.top-menu.mobile', localized_data);
            });
    </script>
    <script src="~/js/public.menu.js" asp-location="Footer"></script>
}
else
{
    <script asp-location="Footer">
       $(document).ready(function () {
            $("#mobile-menu .dropdown .fa-angle-down").on('click', function () {
                var $this = $(this);
                $this.siblings("ul.dropdown-menu").slideToggle("slow", function () {
                    if ($this.siblings("ul.dropdown-menu").css('display') == 'block')
                        $this.addClass("rotate");
                    else if ($this.siblings("ul.dropdown-menu").css('display') == 'none')
                        $this.removeClass("rotate");
                });
            });
        });
    </script>
}

